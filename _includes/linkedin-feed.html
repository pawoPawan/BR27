<!-- LinkedIn Feed Component - Reusable Include -->
<!-- Usage: {% include linkedin-feed.html posts_count="3" carousel="true" %} -->

{% assign posts_count = include.posts_count | default: 3 %}
{% assign carousel = include.carousel | default: "true" %}
{% assign auto_refresh = include.auto_refresh | default: "true" %}

<!-- LinkedIn Feed Section -->
<section class="linkedin-feed-section">
    <div class="container">
        <div class="linkedin-header">
            <div class="linkedin-title-group">
                <div class="linkedin-icon">
                    <svg viewBox="0 0 24 24" fill="white" width="24" height="24">
                        <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/>
                        <rect x="2" y="9" width="4" height="12"/>
                        <circle cx="4" cy="4" r="2"/>
                    </svg>
                </div>
                <div>
                    <h2>Latest from BR27</h2>
                    <p style="color: var(--text-secondary); margin: 0; font-size: 14px;">
                        Follow our journey on LinkedIn
                    </p>
                </div>
            </div>
            <a href="https://www.linkedin.com/company/27br/" 
               target="_blank" 
               rel="noopener noreferrer" 
               class="linkedin-follow-btn">
                <svg viewBox="0 0 24 24" fill="white" width="18" height="18">
                    <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/>
                    <rect x="2" y="9" width="4" height="12"/>
                    <circle cx="4" cy="4" r="2"/>
                </svg>
                Follow on LinkedIn
            </a>
        </div>
        <div id="linkedin-feed-container"></div>
    </div>
</section>

<!-- LinkedIn Feed Script with Platform Detection -->
<script>
    (function() {
        if (typeof LinkedInFeedClient !== 'undefined') {
            document.addEventListener('DOMContentLoaded', function() {
                // Load platform config for adaptive routing
                fetch('/config/platform.json')
                    .then(response => response.json())
                    .then(platformConfig => {
                        const platform = platformConfig.platform.current;
                        const routing = platformConfig.routing[platform];
                        const features = platformConfig.features;
                        
                        // Determine data source based on platform
                        let dataSource;
                        if (features.api_enabled && routing.api_path) {
                            // Use Django API when available
                            dataSource = routing.api_path + 'linkedin/posts/';
                        } else {
                            // Use static JSON for GitHub Pages
                            dataSource = routing.static_path + 'components/linkedin-feed/data/posts.json';
                        }
                        
                        // Initialize with platform-aware settings
                        new LinkedInFeedClient('linkedin-feed-container', {
                            postsToShow: {{ posts_count }},
                            companyUrl: 'https://www.linkedin.com/company/27br/',
                            carousel: {{ carousel }},
                            carouselInterval: 5000,
                            autoRefresh: {{ auto_refresh }},
                            refreshInterval: 300000
                        });
                        
                        console.log('✅ LinkedIn feed initialized for platform:', platform);
                    })
                    .catch(error => {
                        // Fallback to static mode if config unavailable
                        console.warn('⚠️ Platform config unavailable, using defaults');
                        new LinkedInFeedClient('linkedin-feed-container', {
                            postsToShow: {{ posts_count }},
                            companyUrl: 'https://www.linkedin.com/company/27br/',
                            carousel: {{ carousel }},
                            carouselInterval: 5000,
                            autoRefresh: {{ auto_refresh }},
                            refreshInterval: 300000
                        });
                    });
            });
        }
    })();
</script>

